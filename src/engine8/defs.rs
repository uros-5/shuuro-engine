use shuuro::shuuro8::{
    bitboard8::BB8,
    board_defs::{FILE_BB, RANK_BB},
    square8::Square8,
};

// Piece values - reordered and expanded
pub const PIECE_VALUES: [[i32; 9]; 2] = [
    // Midgame values - White
    [
        0,    // King (no value)
        1025, // Queen
        477,  // Rook
        365,  // Bishop
        337,  // Knight
        82,   // Pawn
        800,  // Chancellor (Rook + Knight)
        700,  // Archbishop (Bishop + Knight)
        300,  // Giraffe (arbitrary value)
    ],
    // Midgame values - Black
    [
        0,   // King
        936, // Queen
        512, // Rook
        297, // Bishop
        281, // Knight
        94,  // Pawn
        750, // Chancellor
        650, // Archbishop
        280, // Giraffe
    ],
];

// Endgame values
pub const ENDGAME_PIECE_VALUES: [[i32; 9]; 2] = [
    // Endgame values - White
    [
        0,   // King
        936, // Queen
        512, // Rook
        297, // Bishop
        281, // Knight
        94,  // Pawn
        750, // Chancellor
        650, // Archbishop
        280, // Giraffe
    ],
    // Endgame values - Black
    [
        0,    // King
        1025, // Queen
        477,  // Rook
        365,  // Bishop
        337,  // Knight
        82,   // Pawn
        800,  // Chancellor
        700,  // Archbishop
        300,  // Giraffe
    ],
];

// Piece-Square Tables - reordered and expanded
pub const PST: [[[i32; 64]; 9]; 2] = [
    // White pieces
    [
        // King (midgame)
        [
            -65, 23, 16, -15, -56, -34, 2, 13, 29, -1, -20, -7, -8, -4, -38, -29, -9, 24, 2, -16,
            -20, 6, 22, -22, -17, -20, -12, -27, -30, -25, -14, -36, -49, -1, -27, -39, -46, -44,
            -33, -51, -14, -14, -22, -46, -44, -30, -15, -27, 1, 7, -8, -64, -43, -16, 9, 8, -15,
            36, 12, -54, 8, -28, 24, 14,
        ],
        // Queen
        [
            -28, 0, 29, 12, 59, 44, 43, 45, -24, -39, -5, 1, -16, 57, 28, 54, -13, -17, 7, 8, 29,
            56, 47, 57, -27, -27, -16, -16, -1, 17, -2, 1, -9, -26, -9, -10, -2, -4, 3, -3, -14, 2,
            -11, -2, -5, 2, 14, 5, -35, -8, 11, 2, 8, 15, -3, 1, -1, -18, -9, 10, -15, -25, -31,
            -50,
        ],
        // Rook
        [
            32, 42, 32, 51, 63, 9, 31, 43, 27, 32, 58, 62, 80, 67, 26, 44, -5, 19, 26, 36, 17, 45,
            61, 16, -24, -11, 7, 26, 24, 35, -8, -20, -36, -26, -12, -1, 9, -7, 6, -23, -45, -25,
            -16, -17, 3, 0, -5, -33, -44, -16, -20, -9, -1, 11, -6, -71, -19, -13, 1, 17, 16, 7,
            -37, -26,
        ],
        // Bishop
        [
            -29, 4, -82, -37, -25, -42, 7, -8, -26, 16, -18, -13, 30, 59, 18, -47, -16, 37, 43, 40,
            35, 50, 37, -2, -4, 5, 19, 50, 37, 37, 7, -2, -6, 13, 13, 26, 34, 12, 10, 4, 0, 15, 15,
            15, 14, 27, 18, 10, 4, 15, 16, 0, 7, 21, 33, 1, -33, -3, -14, -21, -13, -12, -39, -21,
        ],
        // Knight
        [
            -167, -89, -34, -49, 61, -97, -15, -107, -73, -41, 72, 36, 23, 62, 7, -17, -47, 60, 37,
            65, 84, 129, 73, 44, -9, 17, 19, 53, 37, 69, 18, 22, -13, 4, 16, 13, 28, 19, 21, -8,
            -23, -9, 12, 10, 19, 17, 25, -16, -29, -53, -12, -3, -1, 18, -14, -19, -105, -21, -58,
            -33, -17, -28, -19, -23,
        ],
        // Pawn
        [
            0, 0, 0, 0, 0, 0, 0, 0, 98, 134, 61, 95, 68, 126, 34, -11, -6, 7, 26, 31, 65, 56, 25,
            -20, -14, 13, 6, 21, 23, 12, 17, -23, -27, -2, -5, 12, 17, 6, 10, -25, -26, -4, -4,
            -10, 3, 3, 33, -12, -35, -1, -20, -23, -15, 24, 38, -22, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (Rook + Knight) - average of both
        [
            -67, -23, -1, 1, 32, -44, 8, -32, -23, -4, 65, 49, 51, 64, 16, 13, -26, 39, 31, 50, 50,
            87, 67, 30, -16, 3, 22, 37, 30, 52, 13, 1, -24, -11, 14, 12, 18, 6, 13, -15, -34, -17,
            3, -3, 11, 8, 10, -24, -36, -34, -4, -6, 3, 14, -10, -45, -62, -17, -28, -8, -5, -10,
            -28, -24,
        ],
        // Archbishop (Bishop + Knight) - average of both
        [
            -98, -42, -58, -43, 18, -69, -4, -57, -49, -12, 27, 11, 26, 60, 12, -32, -31, 48, 40,
            52, 59, 89, 55, 21, -6, 11, 20, 51, 37, 53, 12, 10, -9, 8, 14, 19, 25, 15, 15, -2, -17,
            3, 5, 12, 16, 10, 7, -15, -15, -19, -16, -1, 2, 19, 9, -21, -69, -12, -36, -13, -15,
            -20, -29, -22,
        ],
        // Giraffe (custom values - adjust as needed)
        [
            -30, -20, -10, -10, -10, -10, -20, -30, -20, 0, 0, 0, 0, 0, 0, -20, -10, 0, 10, 10, 10,
            10, 0, -10, -10, 0, 10, 20, 20, 10, 0, -10, -10, 0, 10, 20, 20, 10, 0, -10, -10, 0, 10,
            10, 10, 10, 0, -10, -20, 0, 0, 0, 0, 0, 0, -20, -30, -20, -10, -10, -10, -10, -20, -30,
        ],
    ],
    // Black pieces (mirrored)
    [
        // King (midgame)
        [
            -15, 36, 12, -54, 8, -28, 24, 14, 1, 7, -8, -64, -43, -16, 9, 8, -14, -14, -22, -46,
            -44, -30, -15, -27, -49, -1, -27, -39, -46, -44, -33, -51, -17, -20, -12, -27, -30,
            -25, -14, -36, -9, 24, 2, -16, -20, 6, 22, -22, 29, -1, -20, -7, -8, -4, -38, -29, -65,
            23, 16, -15, -56, -34, 2, 13,
        ],
        // Queen
        [
            -1, -18, -9, 10, -15, -25, -31, -50, -35, -8, 11, 2, 8, 15, -3, 1, -14, 2, -11, -2, -5,
            2, 14, 5, -9, -26, -9, -10, -2, -4, 3, -3, -27, -27, -16, -16, -1, 17, -2, 1, -13, -17,
            7, 8, 29, 56, 47, 57, -24, -39, -5, 1, -16, 57, 28, 54, -28, 0, 29, 12, 59, 44, 43, 45,
        ],
        // Rook
        [
            -19, -13, 1, 17, 16, 7, -37, -26, -44, -16, -20, -9, -1, 11, -6, -71, -45, -25, -16,
            -17, 3, 0, -5, -33, -36, -26, -12, -1, 9, -7, 6, -23, -24, -11, 7, 26, 24, 35, -8, -20,
            -5, 19, 26, 36, 17, 45, 61, 16, 27, 32, 58, 62, 80, 67, 26, 44, 32, 42, 32, 51, 63, 9,
            31, 43,
        ],
        // Bishop
        [
            -33, -3, -14, -21, -13, -12, -39, -21, 4, 15, 16, 0, 7, 21, 33, 1, 0, 15, 15, 15, 14,
            27, 18, 10, -6, 13, 13, 26, 34, 12, 10, 4, -4, 5, 19, 50, 37, 37, 7, -2, -16, 37, 43,
            40, 35, 50, 37, -2, -26, 16, -18, -13, 30, 59, 18, -47, -29, 4, -82, -37, -25, -42, 7,
            -8,
        ],
        // Knight
        [
            -105, -21, -58, -33, -17, -28, -19, -23, -29, -53, -12, -3, -1, 18, -14, -19, -23, -9,
            12, 10, 19, 17, 25, -16, -13, 4, 16, 13, 28, 19, 21, -8, -9, 17, 19, 53, 37, 69, 18,
            22, -47, 60, 37, 65, 84, 129, 73, 44, -73, -41, 72, 36, 23, 62, 7, -17, -167, -89, -34,
            -49, 61, -97, -15, -107,
        ],
        // Pawn
        [
            0, 0, 0, 0, 0, 0, 0, 0, -35, -1, -20, -23, -15, 24, 38, -22, -26, -4, -4, -10, 3, 3,
            33, -12, -27, -2, -5, 12, 17, 6, 10, -25, -14, 13, 6, 21, 23, 12, 17, -23, -6, 7, 26,
            31, 65, 56, 25, -20, 98, 134, 61, 95, 68, 126, 34, -11, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (mirrored)
        [
            -62, -17, -28, -8, -5, -10, -28, -24, -36, -34, -4, -6, 3, 14, -10, -45, -34, -17, 3,
            -3, 11, 8, 10, -24, -24, -11, 14, 12, 18, 6, 13, -15, -16, 3, 22, 37, 30, 52, 13, 1,
            -26, 39, 31, 50, 50, 87, 67, 30, -23, -4, 65, 49, 51, 64, 16, 13, -67, -23, -1, 1, 32,
            -44, 8, -32,
        ],
        // Archbishop (mirrored)
        [
            -69, -12, -36, -13, -15, -20, -29, -22, -15, -19, -16, -1, 2, 19, 9, -21, -17, 3, 5,
            12, 16, 10, 7, -15, -9, 8, 14, 19, 25, 15, 15, -2, -6, 11, 20, 51, 37, 53, 12, 10, -31,
            48, 40, 52, 59, 89, 55, 21, -49, -12, 27, 11, 26, 60, 12, -32, -98, -42, -58, -43, 18,
            -69, -4, -57,
        ],
        // Giraffe (mirrored)
        [
            -30, -20, -10, -10, -10, -10, -20, -30, -20, 0, 0, 0, 0, 0, 0, -20, -10, 0, 10, 10, 10,
            10, 0, -10, -10, 0, 10, 20, 20, 10, 0, -10, -10, 0, 10, 20, 20, 10, 0, -10, -10, 0, 10,
            10, 10, 10, 0, -10, -20, 0, 0, 0, 0, 0, 0, -20, -30, -20, -10, -10, -10, -10, -20, -30,
        ],
    ],
];

pub const PST_ENDGAME: [[[i32; 64]; 9]; 2] = [
    // White pieces
    [
        // King (endgame - centralization becomes more important)
        [
            -74, -35, -18, -18, -11, 15, 4, -17, -12, 17, 14, 17, 17, 38, 23, 11, 10, 17, 23, 15,
            20, 45, 44, 13, -8, 22, 24, 27, 26, 33, 26, 3, -18, -4, 21, 24, 27, 23, 9, -11, -19,
            -3, 11, 21, 23, 16, 7, -9, -27, -11, 4, 13, 14, 4, -5, -17, -53, -34, -21, -11, -28,
            -14, -24, -43,
        ],
        // Queen (endgame - less aggressive positioning)
        [
            -9, 22, 22, 27, 27, 19, 10, 20, -17, 20, 32, 41, 58, 25, 30, 0, -20, 6, 9, 49, 47, 35,
            19, 9, 3, 22, 24, 45, 57, 40, 57, 36, -18, 28, 19, 47, 31, 34, 39, 23, -16, -27, 15, 6,
            9, 17, 10, 5, -22, -23, -30, -16, -16, -23, -36, -32, -33, -28, -22, -43, -5, -32, -20,
            -41,
        ],
        // Rook (endgame - encourage activity and centralization)
        [
            13, 10, 18, 15, 12, 12, 8, 5, 11, 13, 13, 11, -3, 3, 8, 3, 7, 7, 7, 5, 4, -3, -5, -3,
            4, 3, 13, 1, 2, 1, -1, 2, 3, 5, 8, 4, -5, -6, -8, -11, -4, 0, -5, -1, -7, -12, -8, -16,
            -6, -6, 0, 2, -9, -9, -11, -3, -9, 2, 3, -1, -5, -13, 4, -20,
        ],
        // Bishop (endgame - long diagonals become more valuable)
        [
            -14, -21, -11, -8, -7, -9, -17, -24, -8, -4, 7, -12, -3, -13, -4, -14, 2, -8, 0, -1,
            -2, 6, 0, 4, -3, 9, 12, 9, 14, 10, 3, 2, -6, 3, 13, 19, 7, 10, -3, -9, -12, -3, 8, 10,
            13, 3, -7, -15, -14, -18, -7, -1, 4, -9, -15, -27, -23, -9, -23, -5, -9, -16, -5, -17,
        ],
        // Knight (endgame - centralization important)
        [
            -58, -38, -13, -28, -31, -27, -63, -99, -25, -8, -25, -2, -9, -25, -24, -52, -24, -20,
            10, 9, -1, -9, -19, -41, -17, 3, 22, 22, 22, 11, 8, -18, -18, -6, 16, 25, 16, 17, 4,
            -18, -23, -3, -1, 15, 10, -3, -20, -22, -42, -20, -10, -5, -2, -20, -23, -44, -29, -51,
            -23, -15, -22, -18, -50, -64,
        ],
        // Pawn (endgame - encourage promotion)
        [
            0, 0, 0, 0, 0, 0, 0, 0, 178, 173, 158, 134, 147, 132, 165, 187, 94, 100, 85, 67, 56,
            53, 82, 84, 32, 24, 13, 5, -2, 4, 17, 17, 13, 9, -3, -7, -7, -8, 3, -1, 4, 7, -6, 1, 0,
            -5, -1, -8, 13, 8, 8, 10, 13, 0, 2, -7, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (Rook+Knight hybrid - endgame values)
        [
            -40, -20, -5, -5, 0, -20, -10, -30, -15, 10, 15, 15, 20, 10, 5, -10, -5, 15, 25, 25,
            25, 20, 10, 0, 0, 15, 25, 30, 30, 25, 15, 5, 0, 15, 25, 30, 30, 25, 15, 5, -5, 10, 20,
            25, 25, 20, 10, 0, -15, 5, 10, 15, 15, 10, 0, -15, -40, -20, -10, -5, -5, -10, -20,
            -40,
        ],
        // Archbishop (Bishop+Knight hybrid - endgame values)
        [
            -30, -15, -10, -5, -5, -10, -15, -30, -10, 5, 10, 10, 10, 10, 5, -10, -5, 10, 15, 20,
            20, 15, 10, -5, -5, 10, 20, 25, 25, 20, 10, 0, -5, 10, 20, 25, 25, 20, 10, 0, -5, 10,
            15, 20, 20, 15, 10, -5, -10, 5, 10, 10, 10, 10, 5, -10, -30, -15, -10, -5, -5, -10,
            -15, -30,
        ],
        // Giraffe (custom piece - endgame positioning)
        [
            -20, -10, -5, -5, -5, -5, -10, -20, -10, 5, 10, 10, 10, 10, 5, -10, -5, 10, 15, 15, 15,
            15, 10, -5, -5, 10, 15, 20, 20, 15, 10, -5, -5, 10, 15, 20, 20, 15, 10, -5, -5, 10, 15,
            15, 15, 15, 10, -5, -10, 5, 10, 10, 10, 10, 5, -10, -20, -10, -5, -5, -5, -5, -10, -20,
        ],
    ],
    // Black pieces (mirrored versions)
    [
        // King (mirrored)
        [
            -53, -34, -21, -11, -28, -14, -24, -43, -27, -11, 4, 13, 14, 4, -5, -17, -19, -3, 11,
            21, 23, 16, 7, -9, -18, -4, 21, 24, 27, 23, 9, -11, -8, 22, 24, 27, 26, 33, 26, 3, 10,
            17, 23, 15, 20, 45, 44, 13, -12, 17, 14, 17, 17, 38, 23, 11, -74, -35, -18, -18, -11,
            15, 4, -17,
        ],
        // Queen (mirrored)
        [
            -33, -28, -22, -43, -5, -32, -20, -41, -22, -23, -30, -16, -16, -23, -36, -32, -16,
            -27, 15, 6, 9, 17, 10, 5, -18, 28, 19, 47, 31, 34, 39, 23, 3, 22, 24, 45, 57, 40, 57,
            36, -20, 6, 9, 49, 47, 35, 19, 9, -17, 20, 32, 41, 58, 25, 30, 0, -9, 22, 22, 27, 27,
            19, 10, 20,
        ],
        // Rook (mirrored)
        [
            -9, 2, 3, -1, -5, -13, 4, -20, -6, -6, 0, 2, -9, -9, -11, -3, -4, 0, -5, -1, -7, -12,
            -8, -16, 3, 5, 8, 4, -5, -6, -8, -11, 4, 3, 13, 1, 2, 1, -1, 2, 7, 7, 7, 5, 4, -3, -5,
            -3, 11, 13, 13, 11, -3, 3, 8, 3, 13, 10, 18, 15, 12, 12, 8, 5,
        ],
        // Bishop (mirrored)
        [
            -23, -9, -23, -5, -9, -16, -5, -17, -14, -18, -7, -1, 4, -9, -15, -27, -12, -3, 8, 10,
            13, 3, -7, -15, -6, 3, 13, 19, 7, 10, -3, -9, -3, 9, 12, 9, 14, 10, 3, 2, 2, -8, 0, -1,
            -2, 6, 0, 4, -8, -4, 7, -12, -3, -13, -4, -14, -14, -21, -11, -8, -7, -9, -17, -24,
        ],
        // Knight (mirrored)
        [
            -29, -51, -23, -15, -22, -18, -50, -64, -42, -20, -10, -5, -2, -20, -23, -44, -23, -3,
            -1, 15, 10, -3, -20, -22, -18, -6, 16, 25, 16, 17, 4, -18, -17, 3, 22, 22, 22, 11, 8,
            -18, -24, -20, 10, 9, -1, -9, -19, -41, -25, -8, -25, -2, -9, -25, -24, -52, -58, -38,
            -13, -28, -31, -27, -63, -99,
        ],
        // Pawn (mirrored)
        [
            0, 0, 0, 0, 0, 0, 0, 0, 13, 8, 8, 10, 13, 0, 2, -7, 4, 7, -6, 1, 0, -5, -1, -8, 13, 9,
            -3, -7, -7, -8, 3, -1, 32, 24, 13, 5, -2, 4, 17, 17, 94, 100, 85, 67, 56, 53, 82, 84,
            178, 173, 158, 134, 147, 132, 165, 187, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (mirrored)
        [
            -40, -20, -10, -5, -5, -10, -20, -40, -15, 5, 10, 15, 15, 10, 0, -15, -5, 10, 20, 25,
            25, 20, 10, 0, 0, 15, 25, 30, 30, 25, 15, 5, 0, 15, 25, 30, 30, 25, 15, 5, -5, 15, 25,
            25, 25, 20, 10, 0, -15, 10, 15, 15, 20, 10, 5, -10, -40, -20, -5, -5, 0, -20, -10, -30,
        ],
        // Archbishop (mirrored)
        [
            -30, -15, -10, -5, -5, -10, -15, -30, -10, 5, 10, 10, 10, 10, 5, -10, -5, 10, 15, 20,
            20, 15, 10, -5, -5, 10, 20, 25, 25, 20, 10, 0, -5, 10, 20, 25, 25, 20, 10, 0, -5, 10,
            15, 20, 20, 15, 10, -5, -10, 5, 10, 10, 10, 10, 5, -10, -30, -15, -10, -5, -5, -10,
            -15, -30,
        ],
        // Giraffe (mirrored)
        [
            -20, -10, -5, -5, -5, -5, -10, -20, -10, 5, 10, 10, 10, 10, 5, -10, -5, 10, 15, 15, 15,
            15, 10, -5, -5, 10, 15, 20, 20, 15, 10, -5, -5, 10, 15, 20, 20, 15, 10, -5, -5, 10, 15,
            15, 15, 15, 10, -5, -10, 5, 10, 10, 10, 10, 5, -10, -20, -10, -5, -5, -5, -5, -10, -20,
        ],
    ],
];

pub const PHASE_WEIGHTS: [i32; 9] = [0, 4, 2, 1, 1, 0, 3, 2, 1];
pub const NEIGHBOR_FILES: [BB8<Square8>; 8] = generate_neighbor_files();
pub const PLAYER_TERRITORY: [BB8<Square8>; 2] = generate_player_sides();

const fn generate_neighbor_files() -> [BB8<Square8>; 8] {
    let mut files = [BB8::new(0); 8];
    let mut file = 0;
    while file < 8 {
        if file == 0 {
            files[0] = FILE_BB[1];
        } else if file == 7 {
            files[7] = FILE_BB[6];
        } else {
            let left = FILE_BB[file as usize - 1];
            let right = FILE_BB[file as usize + 1];
            files[file] = BB8::new(left.0 | right.0);
        }
        file += 1;
    }

    files
}

const fn generate_player_sides() -> [BB8<Square8>; 2] {
    let mut white = BB8::new(0);
    let mut black = BB8::new(0);
    let end = 4;
    let mut current_rank = 0;
    while current_rank < end {
        white = BB8::new(white.0 | RANK_BB[current_rank as usize].0);
        current_rank += 1;
    }
    let end = 8;
    let mut current_rank = 4;
    while current_rank < end {
        black = BB8::new(black.0 | RANK_BB[current_rank as usize].0);
        current_rank += 1;
    }
    [white, black]
}
