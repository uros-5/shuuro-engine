use shuuro::shuuro6::{
    bitboard6::BB6,
    board_defs::{FILE_BB, RANK_BB},
    square6::Square6,
};

// Midgame values
#[rustfmt::skip]
pub const PIECE_VALUES: [[i32; 9]; 2] = [
    // White pieces (King, Queen, Rook, Bishop, Knight, Pawn, Chancellor, Archbishop, Giraffe)
    [0, 750, 350, 250, 200, 60, 500, 400, 150],
    // Black pieces (asymmetric for variety)
    [0, 730, 340, 240, 190, 65, 480, 390, 160],
];

// Endgame values
#[rustfmt::skip]
pub const ENDGAME_PIECE_VALUES: [[i32; 9]; 2] = [
    // White
    [0, 800, 400, 270, 220, 70, 550, 450, 120],
    // Black
    [0, 780, 390, 260, 210, 75, 530, 440, 130],
];

// Midgame Piece-Square Tables
#[rustfmt::skip]
pub const PST: [[[i32; 36]; 9]; 2] = [
    // White pieces
    [
        // King (midgame - stay safe)
        [
            -30, -10, 0, 0, -10, -30,
            -10, 10, 20, 20, 10, -10,
            0, 20, 30, 30, 20, 0,
            0, 20, 30, 30, 20, 0,
            -10, 10, 20, 20, 10, -10,
            -30, -10, 0, 0, -10, -30,
        ],
        // Queen (control center)
        [
            -20, -10, -5, -5, -10, -20,
            -10, 15, 20, 20, 15, -10,
            -5, 20, 25, 25, 20, -5,
            -5, 20, 25, 25, 20, -5,
            -10, 15, 20, 20, 15, -10,
            -20, -10, -5, -5, -10, -20,
        ],
        // Rook (control files)
        [
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
        ],
        // Bishop (diagonal control)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,
        ],
        // Knight (central outposts)
        [
            -10, -5, 0, 0, -5, -10,
            -5, 10, 15, 15, 10, -5,
            0, 15, 20, 20, 15, 0,
            0, 15, 20, 20, 15, 0,
            -5, 10, 15, 15, 10, -5,
            -10, -5, 0, 0, -5, -10,

        ],
        // Pawn (advancement)
        [
            0, 0, 0, 0, 0, 0,
            10, 15, 20, 20, 15, 10,
            20, 25, 30, 30, 25, 20,
            30, 35, 40, 40, 35, 30,
            40, 45, 50, 50, 45, 40,
            0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (Rook + Knight hybrid)
        [
            5, 10, 15, 15, 10, 5,
            10, 20, 25, 25, 20, 10,
            15, 25, 35, 35, 25, 15,
            15, 25, 35, 35, 25, 15,
            10, 20, 25, 25, 20, 10,
            5, 10, 15, 15, 10, 5,
        ],
        // Archbishop (Bishop + Knight hybrid)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,
        ],
        // Giraffe (2,1 leaper - central control)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,
        ],
    ],
    [
        // King (midgame - stay safe)
        [
            -30, -10, 0, 0, -10, -30,
            -10, 10, 20, 20, 10, -10,
            0, 20, 30, 30, 20, 0,
            0, 20, 30, 30, 20, 0,
            -10, 10, 20, 20, 10, -10,
            -30, -10, 0, 0, -10, -30,

        ],
        // Queen (control center)
        [
            -20, -10, -5, -5, -10, -20,
            -10, 15, 20, 20, 15, -10,
            -5, 20, 25, 25, 20, -5,
            -5, 20, 25, 25, 20, -5,
            -10, 15, 20, 20, 15, -10,
            -20, -10, -5, -5, -10, -20,

        ],
        // Rook (control files)
        [
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,
            5, 10, 15, 15, 10, 5,

        ],
        // Bishop (diagonal control)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,

        ],
        // Knight (central outposts)
        [
            -10, -5, 0, 0, -5, -10,
            -5, 10, 15, 15, 10, -5,
            0, 15, 20, 20, 15, 0,
            0, 15, 20, 20, 15, 0,
            -5, 10, 15, 15, 10, -5,
            -10, -5, 0, 0, -5, -10,

        ],
        // Pawn (advancement)
        [
            0, 0, 0, 0, 0, 0,
            40, 45, 50, 50, 45, 40,
            30, 35, 40, 40, 35, 30,
            20, 25, 30, 30, 25, 20,
            10, 15, 20, 20, 15, 10,
            0, 0, 0, 0, 0, 0,

        ],
        // Chancellor (Rook + Knight hybrid)
        [
            5, 10, 15, 15, 10, 5,
            10, 20, 25, 25, 20, 10,
            15, 25, 35, 35, 25, 15,
            15, 25, 35, 35, 25, 15,
            10, 20, 25, 25, 20, 10,
            5, 10, 15, 15, 10, 5,

        ],
        // Archbishop (Bishop + Knight hybrid)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,

        ],
        // Giraffe (2,1 leaper - central control)
        [
            0, 5, 10, 10, 5, 0,
            5, 15, 20, 20, 15, 5,
            10, 20, 25, 25, 20, 10,
            10, 20, 25, 25, 20, 10,
            5, 15, 20, 20, 15, 5,
            0, 5, 10, 10, 5, 0,
        ],
    ],
];

#[rustfmt::skip]
pub const PST_ENDGAME: [[[i32; 36]; 9]; 2] = [
    // White pieces
    [
        // King (centralization critical)
        [
          -10, -5, 0, 0, -5, -10,
          -5, 10, 15, 15, 10, -5,
          0, 15, 25, 25, 15, 0,
          0, 15, 25, 25, 15, 0,
          -5, 10, 15, 15, 10, -5,
          -10, -5, 0, 0, -5, -10,

        ],
        // Queen (king attack focus)
        [
          -10, -5, 0, 0, -5, -10,
          -5, 10, 15, 15, 10, -5,
          0, 15, 20, 20, 15, 0,
          0, 15, 20, 20, 15, 0,
          -5, 10, 15, 15, 10, -5,
          -10, -5, 0, 0, -5, -10,

        ],
        // Rook (7th rank emphasis)
        [
          5, 10, 15, 15, 10, 5,
          20, 25, 30, 30, 25, 20,
          10, 15, 20, 20, 15, 10,
          10, 15, 20, 20, 15, 10,
          5, 10, 15, 15, 10, 5,
          0, 0, 0, 0, 0, 0,

        ],
        // Bishop (long diagonals)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,

        ],
        // Knight (central outposts)
        [
          -5, 0, 5, 5, 0, -5,
          0, 10, 15, 15, 10, 0,
          5, 15, 20, 20, 15, 5,
          5, 15, 20, 20, 15, 5,
          0, 10, 15, 15, 10, 0,
          -5, 0, 5, 5, 0, -5,

        ],
        // Pawn (promotion urgency)
        [
          0, 0, 0, 0, 0, 0,
          20, 25, 30, 30, 25, 20,
          30, 35, 40, 40, 35, 30,
          40, 45, 50, 50, 45, 40,
          50, 55, 60, 60, 55, 50,
          0, 0, 0, 0, 0, 0,

        ],
        // Chancellor (Rook+Knight endgame power)
        [
          5, 10, 15, 15, 10, 5,
          10, 20, 25, 25, 20, 10,
          15, 25, 35, 35, 25, 15,
          15, 25, 35, 35, 25, 15,
          10, 20, 25, 25, 20, 10,
          5, 10, 15, 15, 10, 5,

        ],
        // Archbishop (Bishop+Knight endgame value)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,

        ],
        // Giraffe (central control emphasis)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,
        ],
    ],
    [
        // King (centralization critical)
        [
          -10, -5, 0, 0, -5, -10,
          -5, 10, 15, 15, 10, -5,
          0, 15, 25, 25, 15, 0,
          0, 15, 25, 25, 15, 0,
          -5, 10, 15, 15, 10, -5,
          -10, -5, 0, 0, -5, -10,

        ],
        // Queen (king attack focus)
        [
          -10, -5, 0, 0, -5, -10,
          -5, 10, 15, 15, 10, -5,
          0, 15, 20, 20, 15, 0,
          0, 15, 20, 20, 15, 0,
          -5, 10, 15, 15, 10, -5,
          -10, -5, 0, 0, -5, -10,

        ],
        // Rook (7th rank emphasis)
        [
          0, 0, 0, 0, 0, 0,
          5, 10, 15, 15, 10, 5,
          10, 15, 20, 20, 15, 10,
          10, 15, 20, 20, 15, 10,
          20, 25, 30, 30, 25, 20,
          5, 10, 15, 15, 10, 5,

        ],
        // Bishop (long diagonals)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,

        ],
        // Knight (central outposts)
        [
          -5, 0, 5, 5, 0, -5,
          0, 10, 15, 15, 10, 0,
          5, 15, 20, 20, 15, 5,
          5, 15, 20, 20, 15, 5,
          0, 10, 15, 15, 10, 0,
          -5, 0, 5, 5, 0, -5,

        ],
        // Pawn (promotion urgency)
        [
          0, 0, 0, 0, 0, 0,
          50, 55, 60, 60, 55, 50,
          40, 45, 50, 50, 45, 40,
          30, 35, 40, 40, 35, 30,
          20, 25, 30, 30, 25, 20,
          0, 0, 0, 0, 0, 0,

        ],
        // Chancellor (Rook+Knight endgame power)
        [
          5, 10, 15, 15, 10, 5,
          10, 20, 25, 25, 20, 10,
          15, 25, 35, 35, 25, 15,
          15, 25, 35, 35, 25, 15,
          10, 20, 25, 25, 20, 10,
          5, 10, 15, 15, 10, 5,

        ],
        // Archbishop (Bishop+Knight endgame value)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,

        ],
        // Giraffe (central control emphasis)
        [
          0, 5, 10, 10, 5, 0,
          5, 15, 20, 20, 15, 5,
          10, 20, 25, 25, 20, 10,
          10, 20, 25, 25, 20, 10,
          5, 15, 20, 20, 15, 5,
          0, 5, 10, 10, 5, 0,

        ],
    ],
];

#[rustfmt::skip]
pub const PHASE_WEIGHTS: [i32; 9] = [
    0, // King
    4, // Queen
    2, // Rook
    1, // Bishop
    1, // Knight
    0, // Pawn
    3, // Chancellor
    2, // Archbishop
    1, // Giraffe
];

#[rustfmt::skip]
pub const NEIGHBOR_FILES: [BB6<Square6>; 6] = generate_neighbor_files();
#[rustfmt::skip]
pub const PLAYER_TERRITORY: [BB6<Square6>; 2] = generate_player_sides();

const fn generate_neighbor_files() -> [BB6<Square6>; 6] {
    let mut files = [BB6::new(0); 6];
    let mut file = 0;
    while file < 6 {
        if file == 0 {
            files[0] = FILE_BB[1];
        } else if file == 5 {
            files[5] = FILE_BB[4];
        } else {
            let left = FILE_BB[file as usize - 1];
            let right = FILE_BB[file as usize + 1];
            files[file] = BB6::new(left.0 | right.0);
        }
        file += 1;
    }

    files
}

const fn generate_player_sides() -> [BB6<Square6>; 2] {
    let mut white = BB6::new(0);
    let mut black = BB6::new(0);
    let end = 3;
    let mut current_rank = 0;
    while current_rank < end {
        white = BB6::new(white.0 | RANK_BB[current_rank as usize].0);
        current_rank += 1;
    }
    let end = 6;
    let mut current_rank = 3;
    while current_rank < end {
        black = BB6::new(black.0 | RANK_BB[current_rank as usize].0);
        current_rank += 1;
    }
    [white, black]
}
