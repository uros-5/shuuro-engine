use shuuro::shuuro12::{
    bitboard12::BB12,
    board_defs::{FILE_BB, RANK_BB},
    square12::Square12,
};

#[rustfmt::skip]
pub const PIECE_VALUES: [[i32; 9]; 2] = [
    [
        0,    // King (effectively infinite, but using a large number)
        1100, // Queen
        600,  // Rook
        400,  // Bishop
        350,  // Knight
        90,   // Pawn
        1200, // Chancellor (Rook + Knight)
        950,  // Archbishop (Bishop + Knight)
        200,  // Giraffe (reduced strength as requested)
    ],
    // Black pieces [0][1]
    [
        0,    // King
        1100, // Queen
        600,  // Rook
        390,  // Bishop
        360,  // Knight
        120,  // Pawn
        1200, // Chancellor
        950,  // Archbishop
        200,  // Giraffe (reduced strength)
    ],
];

#[rustfmt::skip]
pub const ENDGAME_PIECE_VALUES: [[i32; 9]; 2] = [
    // White pieces [1][0]
    [
        0,    // King (effectively infinite)
        1150, // Queen
        650,  // Rook
        480,  // Bishop
        350,  // Knight
        130,  // Pawn
        1250, // Chancellor
        980,  // Archbishop
        200,  // Giraffe (reduced strength as requested)
    ],
    // Black pieces [1][1]
    [
        0,    // King
        1150, // Queen
        650,  // Rook
        420,  // Bishop
        380,  // Knight
        130,  // Pawn
        1250, // Chancellor
        980,  // Archbishop
        200,  // Giraffe (reduced strength)
    ],
];

#[rustfmt::skip]
const fn pst() -> [[[i32; 144]; 9]; 2] {
    let mut pst = [[[0; 144]; 9], [[0; 144]; 9]];
    let black_side =  [
        // King
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -30, -40, -40, -50, -50, -40, -40, -30, 0, 0,
             0, 0, -30, -40, -40, -50, -50, -40, -40, -30, 0, 0,
             0, 0, -30, -40, -40, -50, -50, -40, -40, -30, 0, 0,
             0, 0, -30, -40, -40, -50, -50, -40, -40, -30, 0, 0,
             0, 0, -20, -30, -30, -40, -40, -30, -30, -20, 0, 0,
             0, 0, -10, -20, -20, -20, -20, -20, -20, -10, 0, 0,
             0, 0, 20, 20, 0, 0, 0, 0, 20, 20, 0, 0,
             0, 0, 20, 30, 10, 0, 0, 10, 30, 20, 0, 0,
             10, 10, 30, 30, 10, 10, 10, 30, 30, 30, 10, 10,
             20, 40, 50, 50, 50, 20, 20, 50, 50, 50, 40, 20,
        ],
        // queen
        [
             0, 10, 10, 20, 20, 0, 0, 20, 20, 10, 10, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -20, -10, -10, -5, -5, -10, -10, -20, 0, 0,
             0, 0, -10, 0, 45, 0, 0, 45, 0, -10, 0, 0,
             0, 0, -10, 5, 5, 5, 5, 5, 0, -10, 0, 0,
             0, 0, 0, 30, 15, 15, 15, 15, 30, -5, 0, 0,
             0, 0, -5, 30, 20, 20, 20, 20, 30, -5, 0, 0,
             0, 0, -10, 0, 5, 5, 5, 5, 0, -10, 0, 0,
             0, 0, -10, 0, 0, 0, 0, 0, 0, -10, 0, 0,
             0, 0, 20, 10, 10, 5, 5, 10, 10, 20, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 10, 20, 20, 10, 0, 0, 0, 0,
        ],
        // Rook
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 5, 30, 30, 30, 30, 5, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 15, 0, 0, 0, 0, 0, 0, 15, 0, 0,
             0, 0, 15, 0, 5, 5, 5, 5, 0, 15, 0, 0,
             0, 0, 15, 0, 0, 0, 0, 0, 0, 15, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 10, 10, 10, 20, 20, 20, 10, 10, 10, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 5, 5, 5, 0, 0, 0, 0, 5, 5, 5, 0,
        ],
        // Bishop
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -20, -10, -10, -10, -10, -10, -10, -20, 0, 0,
             0, 0, -10, 5, 0, 0, 0, 0, 5, -10, 0, 0,
             0, 0, -10, 10, 10, 10, 10, 10, 10, -10, 0, 0,
             10, 0, -10, 0, 10, 10, 10, 10, 0, -10, 0, 10,
             0, 0, -10, 5, 5, 10, 10, 5, 5, -10, 0, 0,
             0, 0, -10, 0, 5, 10, 10, 5, 0, -10, 0, 0,
             20, 0, -10, 0, 0, 0, 0, 0, 0, -10, 0, 20,
             0, 0, -20, -10, -10, -10, -10, -10, -10, -20, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 20, 0, 0, 10, 10, 10, 10, 0, 0, 20, 0,
        ],
        // Knight
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -50, -40, -30, -30, -30, -30, -40, -50, 0, 0,
             0, 0, -40, -20, 0, 5, 5, 0, -20, -40, 0, 0,
             0, 20, 30, 5, 10, 15, 15, 10, 5, 30, 20, 0,
             0, 20, 30, 0, 15, 20, 20, 15, 0, 30, 20, 0,
             0, 20, 30, 5, 15, 20, 20, 15, 5, 30, 20, 0,
             0, 20, 30, 0, 10, 15, 15, 10, 0, 30, 20, 0,
             0, 0, -40, -20, 5, 5, 5, 5, -20, -40, 0, 0,
             0, 0, -50, -40, -30, -30, -30, -30, -40, -50, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 10, 10, 10, 10, 0, 0, 0, 0,
        ],
        // Pawn
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 30, 30, 30, 35, 35, 35, 0, 0, 0,
             0, 0, 0, 20, 20, 20, 25, 25, 25, 0, 0, 0,
             0, 0, 0, 5, 5, 10, 25, 25, 5, 0, 0, 0,
             0, 0, 0, 5, 10, 10, -20, -20, 5, 0, 0, 0,
             0, 0, 0, 5, -5, -10, 0, -5, 5, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 20, 20, 0, 0, 0, 0,
             0, 0, 0, 10, 10, 20, 30, 30, 10, 0, 0, 0,
             0, 0, 0, 50, 50, 50, 50, 50, 50, 0, 0, 0,
             0, 10, 10, 5, 5, 5, 5, 5, 5, 10, 10, 0,
             0, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        // Chancellor (Rook + Knight) (7)
        [
             0, 10, 10, 10, 0, 0, 0, 0, 10, 10, 10, 0,
             0, 0, 20, 0, 0, 0, 0, 0, 0, 20, 0, 0,
             0, 0, 20, -10, -5, 0, 0, -5, -10, 20, 0, 0,
             0, 0, -10, 10, 10, 10, 10, 10, 10, -10, 0, 0,
             0, 10, -5, 10, 20, 20, 20, 20, 10, -5, 10, 0,
             0, 10, 0, 10, 20, 25, 25, 20, 10, 0, 10, 0,
             0, 10, 0, 10, 20, 25, 25, 20, 10, 0, 10, 0,
             0, 10, -5, 10, 15, 20, 20, 15, 10, -5, 10, 0,
             0, 10, -10, 5, 5, 5, 5, 5, 5, -10, 10, 0,
             0, 0, -20, -10, -5, 0, 0, -5, -10, -20, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 5, 0, 0, 0, 0, 0, 0, 5, 0, 0,
        ],
        // Archbishop (Bishop + Knight) (8)
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -20, -10, -10, -10, -10, -10, -10, -20, 0, 0,
             0, 0, -10, 5, 5, 5, 5, 5, 5, -10, 0, 0,
             0, 20, -10, 5, 15, 15, 15, 15, 5, -10, 20, 0,
             0, 20, -10, 5, 15, 20, 20, 15, 5, -10, 20, 0,
             10, 20, -10, 5, 15, 20, 20, 15, 5, -10, 20, 10,
             0, 20, -10, 5, 15, 15, 15, 15, 5, -10, 20, 0,
             0, 20, -10, 5, 5, 5, 5, 5, 5, -10, 20, 0,
             0, 0, -20, -10, -10, -10, -10, -10, -10, -20, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 20, 0, 0, 10, 10, 10, 10, 0, 0, 20, 0,
        ],
        [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, -30, -20, -10, -10, -10, -10, -20, -30, 0, 0,
             0, 0, -20, 0, 5, 5, 5, 5, 0, -20, 0, 0,
             0, 0, -10, 5, 10, 10, 10, 10, 5, -10, 0, 0,
             0, 0, -10, 5, 10, 15, 15, 10, 5, -10, 0, 0,
             0, 0, -10, 5, 10, 15, 15, 10, 5, -10, 0, 0,
             0, 0, -10, 5, 10, 10, 10, 10, 5, -10, 0, 0,
             0, 0, -20, 0, 5, 5, 5, 5, 0, -20, 0, 0,
             0, 0, -30, -20, -10, -10, -10, -10, -20, -30, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
             
    ];
    let mut piece = 0;
    while piece < 9 {
        let squares = black_side[piece];
        let mut index = 0;
        while index < 144 {
            let value = squares[index];
            let file = index % 12;
            let rank = 11 - (index / 12);
            let sq = rank * 12 + file;
            pst[0][piece][sq] = value;
            index += 1;
        }
        piece += 1;
    }
    pst[1] = black_side;
    pst
}

#[rustfmt::skip]
const fn pst_endgame() -> [[[i32; 144]; 9]; 2] {
    let mut pst = [[[0; 144]; 9], [[0; 144]; 9]];
    let mut black_side = PST[1];
    black_side[0] = [
             5, 10, 10, 10, 20, 0, 0, 20, 10, 10, 10, 5,
             10, 30, 30, 30, 0, 0, 0, 0, 30, 30, 10, 10,
             0, 10, 30, 20, 0, 0, 0, 0, 20, 30, 10, 0,
             0, 0, 20, 20, 20, 0, 0, 20, 20, 20, 0, 0,
             -20, -20, -20, -10, 20, 0, 0, 20, -10, -20, -20, -20,
             -40, -30, -30, -20, 20, 0, 0, 20, -20, -30, -30, -40,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 20, 20, 10, 10, 20, 20, 0, 0, 0,
             10, 40, 40, 30, 0, 0, 0, 0, 30, 40, 40, 10,
             -50, -40, -40, -30, 40, 0, 0, 40, -30, -40, -40, -50,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ];
    black_side[5] = [
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 40, 40, 40, 40, 40, 40, 40, 40, 0, 0,
             0, 0, 20, 20, 20, 20, 20, 20, 20, 20, 0, 0,
             0, 0, 0, 5, 10, 10, -10, -10, 5, 0, 0, 0,
             0, 0, 0, 5, -5, -10, 0, -5, 5, 0, 0, 0,
             0, 0, 0, 0, 0, 0, 20, 20, 0, 0, 0, 0,
             0, 0, 0, 5, 5, 10, 25, 25, 5, 0, 0, 0,
             0, 0, 0, 5, 5, 20, 30, 30, 5, 0, 0, 0,
             0, 0, 0, 50, 50, -50, -50, 50, 50, 0, 0, 0,
             0, 10, 10, 0, 0, 0, 0, 0, 0, 10, 10, 0,
             0, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ];
    let mut piece = 0;
    while piece < 9 {
        let squares = black_side[piece];
        let mut index = 0;
        while index < 144 {
            let value = squares[index];
            let file = index % 12;
            let rank = 11 - (index / 12);
            let sq = rank * 12 + file;
            pst[0][piece][sq] = value;
            index += 1;
        }
        piece += 1;
    }
    pst[1] = black_side;
    pst
}

// Midgame Piece-Square Tables
#[rustfmt::skip]
pub const PST: [[[i32; 144]; 9]; 2] = pst();

#[rustfmt::skip]
pub const PST_ENDGAME: [[[i32; 144]; 9]; 2] = pst_endgame();

#[rustfmt::skip]
pub const NEIGHBOR_FILES: [BB12<Square12>; 12] = generate_neighbor_files();
#[rustfmt::skip]
pub const PLAYER_TERRITORY: [BB12<Square12>; 2] = generate_player_sides();

#[rustfmt::skip]
pub const PHASE_WEIGHTS: [i32; 9] = [
    0, // King
    4, // Queen
    2, // Rook
    2, // Bishop
    3, // Knight
    0, // Pawn
    3, // Chancellor
    2, // Archbishop
    1, // Giraffe
];

const fn generate_neighbor_files() -> [BB12<Square12>; 12] {
    let mut files = [BB12::new(0, 0); 12];
    let mut file = 0;
    while file < 12 {
        if file == 0 {
            files[0] = FILE_BB[1];
        } else if file == 11 {
            files[11] = FILE_BB[10];
        } else {
            let left = FILE_BB[file as usize - 1];
            let right = FILE_BB[file as usize + 1];
            files[file] = BB12::new(left.0.0 | right.0.0, left.0.1 | right.0.1);
        }
        file += 1;
    }

    files
}

const fn generate_player_sides() -> [BB12<Square12>; 2] {
    let mut white = BB12::new(0, 0);
    let mut black = BB12::new(0, 0);
    let end = 4;
    let mut current_rank = 0;
    while current_rank < end {
        let rank = RANK_BB[current_rank as usize];
        white = BB12::new(white.0.0 | rank.0.0, white.0.1 | rank.0.1);
        current_rank += 1;
    }
    let end = 8;
    let mut current_rank = 4;
    while current_rank < end {
        let rank = RANK_BB[current_rank as usize];
        black = BB12::new(black.0.0 | rank.0.0, black.0.1 | rank.0.1);
        current_rank += 1;
    }
    [white, black]
}
